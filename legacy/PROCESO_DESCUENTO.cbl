       IDENTIFICATION DIVISION.
       PROGRAM-ID. PROCESO-DESCUENTO.
       AUTHOR. ANTIGRAVITY.

       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01  WS-CLIENTE.
           05  WS-ID-CLIENTE       PIC 9(05).
           05  WS-NOMBRE-CLIENTE   PIC X(30).
           05  WS-SALDO            PIC 9(07)V99.
       01  WS-RESULTADOS.
           05  WS-DESCUENTO        PIC 9(05)V99.
           05  WS-SALDO-FINAL      PIC 9(07)V99.
       
       01  WS-CONSTANTES.
           05  WS-PCT-DESCUENTO    PIC V99 VALUE .10.

       PROCEDURE DIVISION.
       1000-MAIN.
           DISPLAY "INICIANDO PROCESO DE DESCUENTO MAINFRAME".
           
           *> SIMULACION DE ENTRADA
           MOVE 12345 TO WS-ID-CLIENTE.
           MOVE "JUAN PEREZ" TO WS-NOMBRE-CLIENTE.
           MOVE 1000.00 TO WS-SALDO.

           PERFORM 2000-CALCULAR-DESCUENTO.
           
           DISPLAY "CLIENTE: " WS-NOMBRE-CLIENTE.
           DISPLAY "SALDO ORIGINAL: " WS-SALDO.
           DISPLAY "DESCUENTO APLICADO: " WS-DESCUENTO.
           DISPLAY "SALDO FINAL: " WS-SALDO-FINAL.

           STOP RUN.

       2000-CALCULAR-DESCUENTO.
           IF WS-SALDO > 500.00
               COMPUTE WS-DESCUENTO = WS-SALDO * WS-PCT-DESCUENTO
           ELSE
               MOVE 0 TO WS-DESCUENTO
           END-IF.
           SUBTRACT WS-DESCUENTO FROM WS-SALDO GIVING WS-SALDO-FINAL.
